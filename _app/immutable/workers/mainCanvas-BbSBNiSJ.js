(function(){"use strict";const n=self,w=30;let m,f=1,e={width:0,height:0},i,l,z=0,u=0,b=40,y=1e3/b;function k(t,s,M,g,x){return Math.max((t-s)*(x-g)/(M-s)+g,0)}function F(t){t.clearRect(0,0,e.width,e.height)}function q(t){const s=[];function M(){const r=Math.max(e.width,e.height)/640,a=Math.floor(Math.random()*e.width),o=Math.floor(Math.random()*e.height),c=0,p=0,h=(r*.35+.35)*Math.random()+.3,d=Math.random()*.25+.75,C=Math.random()*.75+.5,S=(Math.random()-.5)*.1,X=(Math.random()-1.15)*.2,Y=Math.random()>.4,R={x:a,y:o,translateX:c,translateY:p,size:h,alpha:d,targetAlpha:C,dx:S,dy:X,white:Y};s.push(R)}function g(r){const{x:a,y:o,translateX:c,translateY:p,size:h,alpha:d,white:C}=r;t.fillStyle=C?`rgba(255, 255, 255, ${d})`:`rgba(190, 131, 84, ${d})`,t.fillRect(Math.floor(a),Math.floor(o),Math.floor(h*2),Math.floor(h*2))}function x(){for(let r=0;r<w;r++){const a=s[r],c=[a.x+a.translateX-a.size,e.width-a.x-a.translateX-a.size,a.y+a.translateY-a.size,e.height-a.y-a.translateY-a.size].reduce((h,d)=>Math.min(h,d)),p=k(c,0,20,0,1);p>1?(a.alpha+=.02,a.alpha>a.targetAlpha&&(a.alpha=a.targetAlpha)):a.alpha=a.targetAlpha*p,a.x+=a.dx,a.y+=a.dy,(a.x<-a.size||a.x>e.width+a.size||a.y<-a.size||a.y>e.height+a.size)&&(s.splice(r,1),M())}}function A(r){const a=r-z;if(z=r,u+=a,u<y){l=n.requestAnimationFrame(A);return}for(;u>=y;)x(),u-=y;t&&F(t);for(let o=0;o<w;o++){const c=s[o];g(c)}l=n.requestAnimationFrame(A)}l=n.requestAnimationFrame(r=>{for(let a=0;a<w;a++)M(),g(s[a]);z=r,l=n.requestAnimationFrame(A)})}n.onmessage=t=>{switch(console.log("mainCanvas: onmessage",t.data),t.data.type){case"new":m=t.data.canvas;break;case"resize":f=t.data.dpr/2,m&&(e=t.data.parentSize,m.width=e.width*f,m.height=e.height*f,i=m.getContext("2d"),i==null||i.scale(f,f));break;case"start":i&&q(i);break;case"stop":l&&(n.cancelAnimationFrame(l),i&&F(i));break}},n.onmessageerror=t=>{console.error("mainCanvas: onmessageerror",t)},n.onerror=t=>{console.error("mainCanvas: onerror",t)}})();
